(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["singer-song-list"],{6048:function(e,t,n){"use strict";var a=n("9ad5"),i=n.n(a);i.a},"9ad5":function(e,t,n){e.exports={menuBg:"#304156",menuText:"#bfcbd9",menuActiveText:"#409eff"}},b05a:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));n("e18c");var a=n("82ae"),i=n.n(a),s="'http://file.dev.zhengzemin.cn'";s="http://file.dev.zhengzemin.cn";var r=function(e){return new Promise((function(t,n){i.a.post("".concat(s,"/bk/music/singerSonger/list"),e).then((function(e){t(e.data.data)})).catch((function(e){n(e.data)}))}))},o=function(e){return new Promise((function(t,n){i.a.post("".concat(s,"/bk/music/singerSonger/upload"),e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){t(e.data)})).catch((function(e){n(e.data)}))}))}},d0d9:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-collapse",{attrs:{accordion:""},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[n("el-collapse-item",{attrs:{name:"search"}},[n("template",{slot:"title"},[e._v(" 搜索歌手清单 "),n("i",{staticClass:"el-icon-search"})]),n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm}},[n("el-form-item",{attrs:{label:"歌曲名"}},[n("el-input",{attrs:{placeholder:"歌曲名"},model:{value:e.searchForm.song,callback:function(t){e.$set(e.searchForm,"song",t)},expression:"searchForm.song"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSongSubmit}},[e._v("查询")]),n("el-button",{on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1)],1)],2),n("el-collapse-item",{directives:[{name:"permission",rawName:"v-permission",value:["admin"],expression:"['admin']"}],attrs:{name:"upload"}},[n("template",{slot:"title"},[e._v(" 上传歌手清单 "),n("i",{staticClass:"el-icon-upload2"})]),n("el-row",{attrs:{gutter:15}},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.musicInfo}},[n("el-form-item",{attrs:{label:"歌手名"}},[n("el-input",{attrs:{placeholder:"歌手名"},model:{value:e.musicInfo.singerName,callback:function(t){e.$set(e.musicInfo,"singerName",t)},expression:"musicInfo.singerName"}})],1),n("el-form-item",{attrs:{label:"歌曲名"}},[n("el-input",{attrs:{placeholder:"歌曲名"},model:{value:e.musicInfo.songName,callback:function(t){e.$set(e.musicInfo,"songName",t)},expression:"musicInfo.songName"}})],1),n("el-form-item",{attrs:{label:"歌曲类型"}},[n("el-select",{attrs:{placeholder:"歌曲类型"},model:{value:e.musicInfo.songType,callback:function(t){e.$set(e.musicInfo,"songType",t)},expression:"musicInfo.songType"}},e._l(e.songTypeOption,(function(e,t){return n("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("上传")]),n("el-button",{on:{click:function(t){return e.resetUpload()}}},[e._v("重置")])],1)],1),n("el-col",{attrs:{span:7}},[n("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"/music/upload","http-request":e.uoload,"file-list":e.fileSongList,"on-change":e.handleSongChange,accept:".mp4, .m4a, .mp3, .flac, .wima"}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v(" 上传歌曲文件 "),n("p"),e._v("将文件拖到此处，或 "),n("em",[e._v("点击上传")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("请上传.mp4, .m4a, .mp3, .flac, .wima文件格式")])])],1),n("el-col",{attrs:{span:7}},[n("el-upload",{ref:"singerImg_upload",staticClass:"upload-demo",attrs:{drag:"",action:"/music/upload","http-request":e.singerImgUpload,"file-list":e.fileSongImgList,"on-change":e.handleSongImgChange,accept:".png, .jpg, .gif, .jpeg"}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v(" 上传歌曲图片文件 "),n("p"),e._v("将文件拖到此处，或 "),n("em",[e._v("点击上传")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("请上传.png, .jpg, .gif, .jpeg文件格式")])])],1)],1)],2)],1),n("el-row",[n("el-table",{staticStyle:{width:"100%","margin-top":"3%"},attrs:{data:e.musicData,border:"","default-sort":{prop:"isSys",order:"descending"}}},[n("el-table-column",{attrs:{width:"120",label:"歌曲图片"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("button",{on:{click:function(t){return e.songLyric(a)}}},[n("el-avatar",{attrs:{shape:"square",size:80,fit:"fill",src:a.img_url}})],1)]}}])}),n("el-table-column",{attrs:{prop:"singerSongName",label:"歌曲名",width:"380"}}),n("el-table-column",{attrs:{prop:"singerName",label:"歌手名",width:"180"}}),n("el-table-column",{attrs:{prop:"singerSongType",label:"歌曲类型",width:"150"}}),n("el-table-column",{attrs:{prop:"fileSize",label:"時長",width:"180"}}),n("el-table-column",{attrs:{label:"音頻"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.play?n("el-button",{attrs:{type:"danger",circle:"",icon:"el-icon-video-pause"},on:{click:function(t){return e.musicPauseBtn(a)}}}):n("el-button",{attrs:{type:"primary",circle:"",icon:"el-icon-video-play"},on:{click:function(t){return e.musicPlayBtn(a,a.song_url,a.singerName,a.singerSongName)}}})]}}])})],1)],1),n("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":[6,12,18,100],"page-size":6,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},i=[],s=(n("fe59"),n("053b"),n("1b84"),n("e18c"),n("96db"),n("08ba"),n("af86"),n("b449"),n("17d6")),r=n("4324"),o=n("1b6a"),l=n("a549"),c=n("7ae9"),u=n("0a8e"),p=n("4bb7"),m=n("b05a"),g=n("9bac"),f=n("9dba"),h=n("fed1"),d=n.n(h),v=function(e){Object(l["a"])(n,e);var t=Object(c["a"])(n);function n(){var e;return Object(r["a"])(this,n),e=t.apply(this,arguments),e.musicData=[],e.ssss="545414554",e.tableKey=0,e.currentDate=new Date,e.page={currentPage:1,total:0,size:6},e.musicInfo={songName:"",singerName:"",songType:"民族"},e.file_list={song_file:[],songImgFile:[]},e.activeNames=["search"],e.searchForm={song:""},e.fileSongList=[],e.fileSongImgList=[],e.songTypeOption=[{label:"民族",value:"0"},{label:"流行",value:"1"},{label:"摇滚",value:"2"},{label:"轻音乐",value:"3"}],e}return Object(o["a"])(n,[{key:"handleSongChange",value:function(e,t){t.length>0&&(this.fileSongList=[t[t.length-1]])}},{key:"handleSongImgChange",value:function(e,t){t.length>0&&(this.fileSongImgList=[t[t.length-1]])}},{key:"init",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.musicInfo.singerName=this.$route.query.singerName+"","轻"==this.musicInfo.singerName&&(this.musicInfo.songType="轻音乐"),e.next=4,Object(m["a"])(d.a.stringify({singerName:this.musicInfo.singerName,singerSongName:this.searchForm.song,current:this.page.currentPage,size:this.page.size}));case 4:return t=e.sent,t[1].records.forEach((function(e){e.play=!1})),this.page.total=t[1].total,this.musicData=t[1].records,e.next=10,g["a"].AudiosPage(this.musicData);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onSongSubmit",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["a"])(d.a.stringify({singerSongName:this.searchForm.song,current:1,size:this.page.size,singerName:this.musicInfo.singerName}));case 2:return t=e.sent,t[1].records.forEach((function(e){e.play=!1})),this.page.total=t[1].total,this.musicData=t[1].records,e.next=8,g["a"].AudiosPage(this.musicData);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"resetForm",value:function(){this.searchForm.song="",this.init()}},{key:"resetUpload",value:function(){this.clearUploadData()}},{key:"songLyric",value:function(e){this.$router.push({path:"/music/singer-song-lyric",query:{singerName:e.singerName,songName:e.singerSongName}})}},{key:"submitUpload",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""===this.musicInfo.songName||0===this.file_list.song_file.length||0===this.file_list.songImgFile.length){e.next=12;break}return t=new FormData,n=Object.assign({username:f["a"].name},this.musicInfo),t.append("info",JSON.stringify(n)),t.append("song_file",this.file_list.song_file.file),t.append("singerImg_file",this.file_list.songImgFile.file),e.next=8,Object(m["b"])(t);case 8:a=e.sent,"true"===a.Success?(this.$message({message:"上传成功",type:"success"}),this.clearUploadData(),this.init()):this.$message.error("上传失败!"),e.next=13;break;case 12:this.$message.error("请检查歌曲和歌曲图片是否有上传!");case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"clearUploadData",value:function(){this.$refs.upload.clearFiles(),this.$refs.singerImg_upload.clearFiles(),this.file_list.song_file=[],this.file_list.songImgFile=[],this.musicInfo.songName=""}},{key:"created",value:function(){this.init()}},{key:"musicPlayBtn",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n,a,i){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.musicData.forEach((function(e){e.play=!1})),t.play=!0,e.next=4,g["a"].MusicPage({url:n,singerName:a,songName:i,play:!0});case 4:case"end":return e.stop()}}),e,this)})));function t(t,n,a,i){return e.apply(this,arguments)}return t}()},{key:"musicPauseBtn",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.play=!1;case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onRoutesChange",value:function(e){console.log(e),console.log("拿不到playasb的store，应该是缓存")}},{key:"getSongType",value:function(e){var t=new Map([["0","民族"],["1","流行"],["2","摇滚"],["3","轻音乐"]]);return t.get(e)?t.get(e):"民族"}},{key:"uoload",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.file_list.song_file=t;case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"singerImgUpload",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.file_list.songImgFile=t;case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.page.size=e,this.page.currentPage=1,this.init()}},{key:"handleCurrentChange",value:function(e){this.page.currentPage=e,this.init()}},{key:"musicpa",get:function(){return g["a"].playasb}}]),n}(p["c"]);Object(u["a"])([Object(p["d"])("musicpa")],v.prototype,"onRoutesChange",null),v=Object(u["a"])([Object(p["a"])({name:"singerSongList"})],v);var b=v,y=b,k=(n("6048"),n("e90a")),_=Object(k["a"])(y,a,i,!1,null,null,null);t["default"]=_.exports}}]);