(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["singer-song-lyric"],{"337e":function(t,e,i){},4194:function(t,e,i){"use strict";var n=i("1c8b"),r=i("5dfd").find,a=i("258f"),s=i("ff9c"),o="find",u=!0,c=s(o);o in[]&&Array(1)[o]((function(){u=!1})),n({target:"Array",proto:!0,forced:u||!c},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},"45a4":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row"),i("el-row",{staticClass:"lyric-content"},[i("el-input",{attrs:{type:"textarea",autosize:""},domProps:{innerHTML:t._s(t.input_lyric)}})],1)],1)},r=[],a=(i("e35a"),i("5e9f"),i("b449"),i("17d6")),s=i("4324"),o=i("1b6a"),u=i("a549"),c=i("7ae9"),l=i("0a8e"),f=i("4bb7"),h=(i("4194"),i("053b"),i("e18c"),i("9cf3"),i("82ae")),m=i.n(h),y="http://zhengzemin.cn",d=function(t){return new Promise((function(e,i){m.a.post(y+":4000/artist/list",t).then((function(t){e(t.data)})).catch((function(t){i(t.data)}))}))},p=function(t){return new Promise((function(e,i){m.a.post(y+":4000/artist/top/song",t).then((function(t){e(t.data)})).catch((function(t){i(t.data)}))}))},v=function(t){return new Promise((function(e,i){m.a.post(y+":4000/song/url",t).then((function(t){e(t.data)})).catch((function(t){i(t.data)}))}))},g=function(t){return new Promise((function(e,i){m.a.post(y+":4000/lyric",t).then((function(t){e(t.data)})).catch((function(t){i(t.data)}))}))},b=function(t){return new Promise((function(e,i){d({type:t.type,area:t.area,limit:t.limit}).then((function(n){var r=n.artists.find((function(e){return-1!=e.name.search(t.singerName)}));p({id:r.id}).then((function(n){var r=n.songs.find((function(e){return-1!=e.name.search(t.songName)}));r?v({id:r.id}).then((function(t){g({id:t.data[0].id}).then((function(t){e(t)}))})):i("查无此歌曲歌词")}))}))}))},_=i("8a9e"),w=i.n(_),L=function(t){Object(u["a"])(i,t);var e=Object(c["a"])(i);function i(){var t;return Object(s["a"])(this,i),t=e.apply(this,arguments),t.musicData=[],t.singerData={singerName:"",songName:"",lyric:[]},t.input_lyric="",t.timer="",t.lrc=[],t}return Object(o["a"])(i,[{key:"mounted",value:function(){}},{key:"created",value:function(){var t=this;this.singerData={singerName:this.$route.query.singerName+"",songName:this.$route.query.songName+"",lyric:[]},this.init(),this.timer=setInterval((function(){t.move()}),300)}},{key:"move",value:function(){var t=document.querySelector(".el-textarea"),e=document.querySelector(".lyric-content");e.scrollTop=e.scrollTop>=t.offsetHeight?0:e.scrollTop+5}},{key:"init",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:b({type:-1,area:7,limit:100,singerName:this.$route.query.singerName,songName:this.$route.query.songName}).then((function(t){var i=e;e.lrc=new w.a({onPlay:function(t,e){i.singerData.lyric.length<t+2&&clearInterval(i.timer),i.input_lyric=i.input_lyric.replace("active-lyric",""),i.input_lyric+='\n          <p class="active-lyric">'.concat(e,"</p>\n          ")},onSetLyric:function(t){i.singerData.lyric=t},offset:150}),e.lrc.setLyric(t.lrc.lyric),e.lrc.play(0)})).catch((function(t){e.input_lyric='\n        <p class="active-lyric">'.concat(t,"</p>\n      ")}));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"beforeDestroy",value:function(){this.timer&&clearInterval(this.timer),this.lrc.pause()}},{key:"refresh",value:function(){}}]),i}(f["c"]);L=Object(l["a"])([Object(f["a"])({name:"song-lyric"})],L);var x=L,N=x,P=(i("5891"),i("e90a")),k=Object(P["a"])(N,n,r,!1,null,null,null);e["default"]=k.exports},5891:function(t,e,i){"use strict";var n=i("337e"),r=i.n(n);r.a},"8a9e":function(t,e,i){
/*!
 * lrc-file-parser.js v1.0.3
 * Author: lyswhut
 * Github: https://github.com/lyswhut/lrc-file-parser
 * License: MIT
 */
!function(e,i){t.exports=i()}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e){function i(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=/^\[([\d:.]*)\]{1}/g,o={title:"ti",artist:"ar",album:"al",offset:"offset",by:"by"},u=performance.now?performance.now.bind(performance):Date.now.bind(Date),c={invokeTime:0,animationFrameId:null,timeoutId:null,callback:null,thresholdTime:200,run:function(){var t=this;this.animationFrameId=window.requestAnimationFrame((function(){t.animationFrameId=null;var e=t.invokeTime-u();if(e>0)return e<t.thresholdTime?t.run():t.timeoutId=setTimeout((function(){t.timeoutId=null,t.run()}),e-t.thresholdTime);t.callback(e)}))},start:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.callback=t,this.invokeTime=u()+e,this.run()},clear:function(){this.animationFrameId&&(window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=null)}};t.exports=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.lyric,n=void 0===i?"":i,a=e.offset,s=void 0===a?150:a,o=e.onPlay,u=void 0===o?function(){}:o,c=e.onSetLyric,l=void 0===c?function(){}:c;r(this,t),this.lyric=n,this.tags={},this.lines=null,this.onPlay=u,this.onSetLyric=l,this.isPlay=!1,this.curLineNum=0,this.maxLine=0,this.offset=s,this.isOffseted=!1,this._nextPerformanceTime=0,this._init()}var e,n,l;return e=t,(n=[{key:"_init",value:function(){this.lyric&&(this._initTag(),this._initLines(),this.onSetLyric(this.lines))}},{key:"_initTag",value:function(){for(var t in o){var e=this.lyric.match(new RegExp("\\[".concat(o[t],":([^\\]]*)]"),"i"));this.tags[t]=e&&e[1]||""}}},{key:"_initLines",value:function(){this.lines=[];for(var t=this.lyric.split("\n"),e=0;e<t.length;e++){var n=t[e].trim();if(s.exec(n)){var r=n.replace(s,"").trim();if(r){var a=RegExp.$1.split(":");a.length<3&&a.unshift(0),a[2].indexOf(".")>-1&&(a.push.apply(a,i(a[2].split("."))),a.splice(2,1)),this.lines.push({time:60*parseInt(a[0])*60*1e3+60*parseInt(a[1])*1e3+1e3*parseInt(a[2])+parseInt(a[3]||0),text:r})}}}this.lines.sort((function(t,e){return t.time-e.time})),this.maxLine=this.lines.length-1}},{key:"_findCurLineNum",value:function(t){for(var e=this.lines.length,i=0;i<e;i++)if(t<=this.lines[i].time)return 0===i?0:i-1;return e-1}},{key:"_handleMaxLine",value:function(){this.onPlay(this.curLineNum,this.lines[this.curLineNum].text),this.pause()}},{key:"_refresh",value:function(){var t=this;this.curLineNum++;var e=this.lines[this.curLineNum],i=this.lines[this.curLineNum+1];if(this.curLineNum===this.maxLine)return this._handleMaxLine();var n=u()-this._nextPerformanceTime;if(this.delay=i.time-e.time,this._nextPerformanceTime+=this.delay,this.delay-=n,this.delay<=0)return this._refresh();!this.isOffseted&&this.delay>=this.offset&&(this._nextPerformanceTime-=this.offset,this.delay-=this.offset,this.isOffseted=!0),c.start((function(){t._refresh()}),this.delay),this.onPlay(this.curLineNum,e.text)}},{key:"play",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.lines.length){if(this.pause(),this.isPlay=!0,this.curLineNum=this._findCurLineNum(e),this.curLineNum===this.maxLine)return this._handleMaxLine();this.delay=this.lines[this.curLineNum+1].time-e,this._nextPerformanceTime=u()+this.delay,this.delay>=this.offset&&(this._nextPerformanceTime-=this.offset,this.delay-=this.offset,this.isOffseted=!0),c.start((function(e){t._refresh(e)}),this.delay),this.onPlay(this.curLineNum,this.lines[this.curLineNum].text)}}},{key:"pause",value:function(){if(this.isPlay&&(this.isPlay=!1,this.isOffseted=!1,c.clear(),this.curLineNum!==this.maxLine)){var t=this._findCurLineNum(this.lines[this.curLineNum+1].time+(u()-this._nextPerformanceTime));this.curLineNum!==t&&this.onPlay(t,this.lines[t].text)}}},{key:"setLyric",value:function(t){this.isPlay&&this.pause(),this.lyric=t,this._init()}}])&&a(e.prototype,n),l&&a(e,l),t}()}])}))}}]);